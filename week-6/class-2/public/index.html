<html>

<head>
     <title>Auth Website</title>
</head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.7.7/axios.min.js"></script>

<body>
     <div>
          Signup
          <input id="register-email" type="text" placeholder="Email" name="email" />
          <input id="register-password" type="text" placeholder="Password" name="password" />
          <button onclick="register()">Register</button>
     </div>
     <br />
     <div>
          Login
          <input id="login-email" type="text" placeholder="Email" name="email" />
          <input id="login-password" type="text" placeholder="Password" name="password" />
          <button onclick="login()">Login</button>
     </div>
     <br />
     <div>
          User Information
          <div id="information"></div>
     </div>
     <br />
     <div>
          <button onclick="logout()">Logout</button>
     </div>

     <script>
          async function register() {
               const email = document.getElementById("register-email").value;
               const password = document.getElementById("register-password").value;

               const response = await axios.post("http://localhost:3000/register", {
                    email: email,
                    password: password,
               });
               console.log("The response is " + response.data);
               alert("User Registered Successfully");
          }

          async function login() {
               const email = document.getElementById("login-email").value;
               const password = document.getElementById("login-password").value;

               const response = await axios.post("http://localhost:3000/login", {
                    email: email,
                    password: password,
               });

               localStorage.setItem("token", response.data.token);
               alert("Login Successfully");
          }

          async function logout() {
               localStorage.removeItem("token");

               alert("Logout Successfully");
          }

          async function getUserInformation() {
               const token = localStorage.getItem("token");

               if (token) {
                    const response = await axios.get("http://localhost:3000/me", {
                         headers: {
                              token: token,
                         },
                    });
                    document.getElementById("information").innerHTML =
                         response.data.email;
               }
          }

          getUserInformation();

     </script>
</body>

</html>